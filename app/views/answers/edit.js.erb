// Fixed Safari error with let/const
// const bestButton = document.querySelector('#button-best-answer-<%= @answer.id %>')
// const cancelButton = document.querySelector('#cancel-edit-<%= @answer.id %>')
var bestButton = {}
bestButton = document.querySelector('#button-best-answer-<%= @answer.id %>');
var cancelButton = {}
cancelButton = document.querySelector('#cancel-edit-<%= @answer.id %>')
// Open form edit
prepend_form()

<% if @answer.errors.present? %>
  document.querySelector('.answer-error-<%= @answer.id %>').innerText = ''
  document.querySelector('.answer-error-<%= @answer.id %>').insertAdjacentHTML('beforeend', '<%= errors_for(@answer) %>');
<% else %>
  <% return unless @answer.persisted? %>
<% end %>


if (cancelButton) {
  cancelButton.addEventListener("click", function(event) {
    event.preventDefault()
    // cancel form open
    revert_form()
  });
}

function prepend_form() {
  if (document.getElementById('answer_<%= @answer.id %>').classList.contains("edited")) {
    document.getElementById('answer_<%= @answer.id %>').classList.remove("edited")
  }
  document.getElementById('form-answer-<%= @answer.id %>').classList.remove('hide')
  document.querySelector('#answer_<%= @answer.id %> .grey').classList.add('hide')
  document.querySelector('#answer-info_<%= @answer.id %>').classList.add('hide')
  document.querySelector('#button-edit-answer-<%= @answer.id %>').classList.add('hide')
  document.querySelector('#button-delete-answer-<%= @answer.id %>').classList.add('hide')
  if (bestButton) {
    document.querySelector('#button-best-answer-<%= @answer.id %>').classList.add('hide')
  }
}

function revert_form() {
  if (document.getElementById('answer_<%= @answer.id %>').classList.contains("edited")) {
    document.getElementById('answer_<%= @answer.id %>').classList.remove("edited")
  }
  document.getElementById('form-answer-<%= @answer.id %>').classList.add('hide')
  document.querySelector('#answer_<%= @answer.id %> .grey').classList.remove('hide')
  document.querySelector('#answer-info_<%= @answer.id %>').classList.remove('hide')
  document.querySelector('#button-edit-answer-<%= @answer.id %>').classList.remove('hide')
  document.querySelector('#button-delete-answer-<%= @answer.id %>').classList.remove('hide')
  if (bestButton) {
    document.querySelector('#button-best-answer-<%= @answer.id %>').classList.remove('hide')
  }
}
